<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Day 4: Manipulating Algebraic Expressions</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Source+Serif+4:opsz,wght@8..60,400;8..60,600;8..60,700&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #fafaf9;
      --surface: #ffffff;
      --surface-alt: #f5f5f4;
      --border: #e7e5e4;
      --border-strong: #d6d3d1;
      --text: #1c1917;
      --text-secondary: #57534e;
      --text-muted: #78716c;
      --accent: #059669;
      --accent-light: #d1fae5;
      --accent-dark: #047857;
      --code-bg: #1e1e1e;
      --code-text: #d4d4d4;
      --success: #16a34a;
      --success-bg: #dcfce7;
      --error: #dc2626;
      --error-bg: #fee2e2;
      --warning: #d97706;
      --warning-bg: #fef3c7;
      --info: #0891b2;
      --info-bg: #cffafe;
      --shadow: 0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04);
      --radius: 8px;
      --radius-lg: 12px;
      --font-serif: 'Source Serif 4', Georgia, serif;
      --font-sans: 'DM Sans', system-ui, sans-serif;
      --font-mono: 'JetBrains Mono', monospace;
    }
    [data-theme="dark"] {
      --bg: #0c0c0f;
      --surface: #16161a;
      --surface-alt: #1c1c21;
      --border: #2a2a32;
      --border-strong: #3a3a44;
      --text: #ececf1;
      --text-secondary: #a1a1aa;
      --text-muted: #71717a;
      --accent: #34d399;
      --accent-light: #064e3b;
      --accent-dark: #6ee7b7;
      --code-bg: #0f0f12;
      --success: #86efac;
      --success-bg: #14532d;
      --error: #fca5a5;
      --error-bg: #7f1d1d;
      --warning: #fde68a;
      --warning-bg: #78350f;
      --info: #a5f3fc;
      --info-bg: #164e63;
    }
    [data-theme="dark"] .nav { background: rgba(22,22,26,0.92); }
    [data-theme="dark"] .warning { color: #fef3c7; }
    [data-theme="dark"] .warning strong { color: #fef3c7; }
    [data-theme="dark"] .info { color: #cffafe; }
    [data-theme="dark"] .rule { color: var(--accent-dark); }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body { font-family: var(--font-sans); background: var(--bg); color: var(--text); line-height: 1.7; font-size: 16px; }
    .nav { position: sticky; top: 0; z-index: 100; background: rgba(250,250,249,0.92); backdrop-filter: blur(12px); border-bottom: 1px solid var(--border); padding: 12px 24px; }
    .nav-inner { max-width: 1200px; margin: 0 auto; display: flex; align-items: center; justify-content: space-between; gap: 16px; }
    .nav-back { display: inline-flex; align-items: center; gap: 8px; color: var(--text-secondary); text-decoration: none; font-weight: 500; font-size: 14px; padding: 8px 12px; border-radius: var(--radius); transition: all 0.15s; }
    .nav-back:hover { background: var(--surface-alt); color: var(--text); }
    .nav-progress { display: flex; align-items: center; gap: 12px; font-size: 13px; color: var(--text-muted); }
    .progress-bar { width: 120px; height: 6px; background: var(--border); border-radius: 999px; overflow: hidden; }
    .progress-fill { height: 100%; background: var(--accent); width: 0%; transition: width 0.3s ease; }
    .theme-toggle { width: 40px; height: 40px; border-radius: var(--radius); border: 1px solid var(--border); background: var(--surface); color: var(--text-secondary); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.15s; }
    .theme-toggle:hover { background: var(--surface-alt); color: var(--text); border-color: var(--border-strong); }
    .hero { max-width: 1200px; margin: 0 auto; padding: 48px 24px 32px; }
    .hero-label { display: inline-flex; align-items: center; gap: 8px; font-size: 13px; font-weight: 600; color: var(--accent-dark); background: var(--accent-light); padding: 6px 12px; border-radius: 999px; margin-bottom: 16px; }
    [data-theme="dark"] .hero-label { color: var(--accent); }
    .hero h1 { font-family: var(--font-serif); font-size: clamp(32px, 5vw, 48px); font-weight: 700; line-height: 1.2; letter-spacing: -0.02em; margin-bottom: 16px; }
    .hero-desc { font-size: 18px; color: var(--text-secondary); max-width: 720px; line-height: 1.6; }
    .hero-meta { display: flex; flex-wrap: wrap; gap: 16px; margin-top: 24px; padding-top: 24px; border-top: 1px solid var(--border); }
    .meta-item { display: flex; align-items: center; gap: 8px; font-size: 14px; color: var(--text-muted); }
    .main-layout { max-width: 1200px; margin: 0 auto; padding: 0 24px 80px; display: grid; grid-template-columns: 260px 1fr; gap: 48px; }
    @media (max-width: 900px) { .main-layout { grid-template-columns: 1fr; } .sidebar { display: none; } }
    .sidebar { position: sticky; top: 80px; align-self: start; }
    .toc { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-lg); padding: 16px; }
    .toc-title { font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-muted); margin-bottom: 12px; }
    .toc-list { list-style: none; }
    .toc-link { display: block; padding: 8px 12px; font-size: 14px; color: var(--text-secondary); text-decoration: none; border-radius: var(--radius); border-left: 2px solid transparent; margin-left: -2px; transition: all 0.15s; }
    .toc-link:hover { color: var(--text); background: var(--surface-alt); }
    .toc-link.active { color: var(--accent-dark); background: var(--accent-light); border-left-color: var(--accent); }
    [data-theme="dark"] .toc-link.active { color: var(--accent); }
    .stats-card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-lg); padding: 16px; margin-top: 16px; }
    .stats-row { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; font-size: 13px; }
    .stats-label { color: var(--text-muted); }
    .stats-value { font-weight: 600; font-family: var(--font-mono); color: var(--text); }
    .content { min-width: 0; }
    .section { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-lg); margin-bottom: 24px; overflow: hidden; }
    .section-header { padding: 24px 28px 20px; border-bottom: 1px solid var(--border); }
    .section-number { font-family: var(--font-mono); font-size: 12px; font-weight: 600; color: var(--accent); margin-bottom: 4px; }
    .section-title { font-family: var(--font-serif); font-size: 24px; font-weight: 700; }
    .section-body { padding: 24px 28px; }
    .subsection { margin-bottom: 32px; }
    .subsection:last-child { margin-bottom: 0; }
    .subsection-title { font-size: 16px; font-weight: 700; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
    .subsection-title::before { content: ''; width: 4px; height: 4px; background: var(--accent); border-radius: 50%; }
    p { margin-bottom: 12px; color: var(--text-secondary); }
    .math-block { background: var(--surface-alt); border: 1px solid var(--border); border-radius: var(--radius); padding: 16px 20px; margin: 16px 0; font-family: var(--font-mono); font-size: 15px; color: var(--text); overflow-x: auto; white-space: pre-wrap; }
    .math-inline { font-family: var(--font-mono); font-size: 14px; background: var(--surface-alt); padding: 2px 6px; border-radius: 4px; }
    .rule { background: var(--accent-light); border-left: 3px solid var(--accent); border-radius: 0 var(--radius) var(--radius) 0; padding: 16px 20px; margin: 16px 0; color: var(--accent-dark); font-weight: 500; }
    [data-theme="dark"] .rule { color: var(--accent); }
    .warning { background: var(--warning-bg); border-left: 3px solid var(--warning); border-radius: 0 var(--radius) var(--radius) 0; padding: 16px 20px; margin: 16px 0; color: #92400e; }
    .warning strong { color: #78350f; }
    [data-theme="dark"] .warning strong { color: #fcd34d; }
    .info { background: var(--info-bg); border-left: 3px solid var(--info); border-radius: 0 var(--radius) var(--radius) 0; padding: 16px 20px; margin: 16px 0; color: #155e75; }
    .code-block { background: var(--code-bg); border-radius: var(--radius); margin: 16px 0; overflow: hidden; }
    .code-header { display: flex; align-items: center; justify-content: space-between; padding: 10px 16px; background: #2d2d2d; border-bottom: 1px solid #3d3d3d; }
    .code-lang { font-family: var(--font-mono); font-size: 12px; font-weight: 600; color: #a1a1aa; text-transform: uppercase; letter-spacing: 0.05em; }
    .code-label { font-size: 12px; color: #71717a; }
    .code-content { padding: 16px 20px; overflow-x: auto; }
    .code-content pre { margin: 0; font-family: var(--font-mono); font-size: 13px; line-height: 1.6; color: var(--code-text); }
    .code-keyword { color: #c586c0; }
    .code-function { color: #dcdcaa; }
    .code-string { color: #ce9178; }
    .code-number { color: #b5cea8; }
    .code-comment { color: #6a9955; }
    .code-type { color: #4ec9b0; }
    ul { margin: 12px 0 12px 24px; color: var(--text-secondary); }
    li { margin-bottom: 8px; }
    li strong { color: var(--text); }
    .two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin: 16px 0; }
    @media (max-width: 700px) { .two-col { grid-template-columns: 1fr; } }
    .video-container { display: grid; grid-template-columns: 1.2fr 1fr; gap: 20px; margin-top: 16px; }
    @media (max-width: 800px) { .video-container { grid-template-columns: 1fr; } }
    .video-player { background: var(--code-bg); border-radius: var(--radius-lg); overflow: hidden; }
    .video-player iframe { width: 100%; aspect-ratio: 16/9; display: block; border: 0; }
    .video-info { padding: 16px; border-top: 1px solid #3d3d3d; }
    .video-title { font-weight: 600; color: #fff; font-size: 14px; margin-bottom: 4px; }
    .video-meta { font-size: 13px; color: #a1a1aa; }
    .video-list { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-lg); overflow: hidden; max-height: 480px; overflow-y: auto; }
    .video-group-title { font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-muted); padding: 16px 16px 8px; background: var(--surface-alt); position: sticky; top: 0; }
    .video-item { display: flex; gap: 12px; padding: 12px 16px; cursor: pointer; border: none; background: transparent; width: 100%; text-align: left; transition: background 0.15s; }
    .video-item:hover { background: var(--surface-alt); }
    .video-item.active { background: var(--accent-light); }
    .video-num { font-family: var(--font-mono); font-size: 12px; color: var(--accent); font-weight: 600; min-width: 24px; }
    .video-item-title { font-size: 14px; font-weight: 500; color: var(--text); line-height: 1.4; }
    .video-item-desc { font-size: 12px; color: var(--text-muted); margin-top: 2px; }
    .quiz-controls { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid var(--border); }
    .btn { display: inline-flex; align-items: center; gap: 6px; padding: 10px 16px; font-size: 14px; font-weight: 600; border-radius: var(--radius); border: 1px solid var(--border); background: var(--surface); color: var(--text); cursor: pointer; transition: all 0.15s; }
    .btn:hover { background: var(--surface-alt); border-color: var(--border-strong); }
    .btn-primary { background: var(--accent); border-color: var(--accent); color: #fff; }
    .btn-primary:hover { background: var(--accent-dark); border-color: var(--accent-dark); }
    .btn-danger { color: var(--error); border-color: var(--error); }
    .btn-danger:hover { background: var(--error-bg); }
    .question { background: var(--surface-alt); border: 1px solid var(--border); border-radius: var(--radius-lg); padding: 20px; margin-bottom: 16px; }
    .question-header { display: flex; align-items: flex-start; justify-content: space-between; gap: 12px; margin-bottom: 12px; }
    .question-num { font-family: var(--font-mono); font-size: 13px; font-weight: 700; color: var(--accent); }
    .question-topic { font-size: 12px; color: var(--text-muted); background: var(--surface); padding: 4px 10px; border-radius: 999px; border: 1px solid var(--border); }
    .question-prompt { font-family: var(--font-mono); font-size: 15px; font-weight: 500; color: var(--text); background: var(--surface); padding: 16px 20px; border-radius: var(--radius); border: 1px solid var(--border); margin-bottom: 16px; line-height: 1.6; }
    .question-input-row { display: flex; gap: 10px; flex-wrap: wrap; }
    .question-input { flex: 1; min-width: 200px; padding: 12px 16px; font-family: var(--font-mono); font-size: 15px; border: 2px solid var(--border); border-radius: var(--radius); background: var(--surface); color: var(--text); outline: none; transition: border-color 0.15s; }
    .question-input:focus { border-color: var(--accent); }
    .question-input.correct { border-color: var(--success); background: var(--success-bg); }
    .question-input.incorrect { border-color: var(--error); background: var(--error-bg); }
    .question-result { margin-top: 12px; font-size: 14px; font-weight: 500; }
    .question-result .success { color: var(--success); }
    .question-result .error { color: var(--error); }
    .question-answer { margin-top: 8px; font-family: var(--font-mono); font-size: 13px; color: var(--accent-dark); background: var(--accent-light); padding: 8px 12px; border-radius: var(--radius); display: inline-block; }
    [data-theme="dark"] .question-answer { color: var(--accent); }
    @media (max-width: 600px) { .hero { padding: 32px 16px 24px; } .main-layout { padding: 0 16px 60px; } .section-header, .section-body { padding: 20px; } }
  </style>
  <script>(function(){const t=localStorage.getItem('math_cs_theme')||(window.matchMedia('(prefers-color-scheme:dark)').matches?'dark':'light');document.documentElement.setAttribute('data-theme',t);})();</script>
</head>
<body>
  <nav class="nav">
    <div class="nav-inner">
      <a href="index.html" class="nav-back">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 12L6 8L10 4"/></svg>
        Back to Curriculum
      </a>
      <div class="nav-progress">
        <span id="progressText">0 / 20 complete</span>
        <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
      </div>
      <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
      </button>
    </div>
  </nav>

  <header class="hero">
    <div class="hero-label">
      <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M8 0L10 6H16L11 9.5L13 16L8 12L3 16L5 9.5L0 6H6L8 0Z"/></svg>
      Day 4 · Foundation
    </div>
    <h1>Manipulating Algebraic Expressions</h1>
    <p class="hero-desc">
      Factoring, expanding, and simplifying are the core operations for transforming expressions. 
      In CS, this translates to optimizing algorithms, simplifying boolean logic, and rewriting code for clarity.
    </p>
    <div class="hero-meta">
      <div class="meta-item">~45 min read</div>
      <div class="meta-item">20 practice problems</div>
      <div class="meta-item">8 video lessons</div>
    </div>
  </header>

  <div class="main-layout">
    <aside class="sidebar">
      <nav class="toc">
        <div class="toc-title">On this page</div>
        <ul class="toc-list">
          <li><a href="#why" class="toc-link">Why This Matters</a></li>
          <li><a href="#expand" class="toc-link">1. Expanding</a></li>
          <li><a href="#factor" class="toc-link">2. Factoring</a></li>
          <li><a href="#simplify" class="toc-link">3. Simplifying</a></li>
          <li><a href="#special" class="toc-link">4. Special Forms</a></li>
          <li><a href="#gotchas" class="toc-link">5. Common Gotchas</a></li>
          <li><a href="#videos" class="toc-link">6. Video Lessons</a></li>
          <li><a href="#practice" class="toc-link">7. Practice Problems</a></li>
        </ul>
      </nav>
      <div class="stats-card">
        <div class="toc-title">Your Progress</div>
        <div class="stats-row"><span class="stats-label">Attempted</span><span class="stats-value" id="statAttempted">0</span></div>
        <div class="stats-row"><span class="stats-label">Correct</span><span class="stats-value" id="statCorrect">0</span></div>
        <div class="stats-row"><span class="stats-label">Accuracy</span><span class="stats-value" id="statAccuracy">—</span></div>
      </div>
    </aside>

    <main class="content">
      <!-- Why This Matters -->
      <section class="section" id="why">
        <div class="section-header">
          <div class="section-number">Section 0</div>
          <h2 class="section-title">Why Expression Manipulation Matters in CS</h2>
        </div>
        <div class="section-body">
          <p>
            Every time you refactor code, optimize a query, or simplify a conditional, you're doing algebraic manipulation.
            The same mental patterns apply to expressions, boolean logic, and algorithm design.
          </p>
          <div class="rule">
            <strong>The core insight:</strong> Factoring finds common structure. Expanding reveals all terms. 
            Simplifying reduces complexity. These are the same operations you do when cleaning up code.
          </div>
          <div class="subsection">
            <h3 class="subsection-title">Where you'll use this</h3>
            <ul>
              <li><strong>Boolean Logic:</strong> De Morgan's laws, simplifying conditionals</li>
              <li><strong>Algorithm Analysis:</strong> Simplifying Big-O expressions like O(n² + 3n + 5) → O(n²)</li>
              <li><strong>Code Refactoring:</strong> Extracting common factors (DRY principle)</li>
              <li><strong>Symbolic Computing:</strong> Computer algebra systems, automatic differentiation</li>
              <li><strong>Compiler Optimization:</strong> Strength reduction, common subexpression elimination</li>
            </ul>
          </div>
          <div class="code-block">
            <div class="code-header"><span class="code-lang">Python</span><span class="code-label">Factoring = extracting common code</span></div>
            <div class="code-content"><pre><span class="code-comment"># Before: repeated computation (not factored)</span>
result1 = x * z + x * w
result2 = y * z + y * w

<span class="code-comment"># After: factored out common structure</span>
common = z + w
result1 = x * common
result2 = y * common

<span class="code-comment"># In algebra: xz + xw = x(z + w)</span>
<span class="code-comment"># Same pattern! Factor out the common term.</span></pre></div>
          </div>
        </div>
      </section>

      <!-- Expanding -->
      <section class="section" id="expand">
        <div class="section-header">
          <div class="section-number">Section 1</div>
          <h2 class="section-title">Expanding Expressions</h2>
        </div>
        <div class="section-body">
          <div class="subsection">
            <h3 class="subsection-title">The distributive property</h3>
            <div class="rule">
              <strong>Core rule:</strong> a(b + c) = ab + ac
            </div>
            <div class="math-block">3(x + 4) = 3x + 12
-2(a - 5) = -2a + 10
x(x + 3) = x² + 3x</div>
          </div>

          <div class="subsection">
            <h3 class="subsection-title">FOIL for binomials</h3>
            <p>When multiplying two binomials, use FOIL: First, Outer, Inner, Last.</p>
            <div class="math-block">(x + 2)(x + 3)

First:  x · x = x²
Outer:  x · 3 = 3x
Inner:  2 · x = 2x
Last:   2 · 3 = 6

Result: x² + 3x + 2x + 6 = x² + 5x + 6</div>
            <div class="code-block">
              <div class="code-header"><span class="code-lang">Python</span><span class="code-label">Expanding with SymPy</span></div>
              <div class="code-content"><pre><span class="code-keyword">from</span> sympy <span class="code-keyword">import</span> symbols, expand

x = <span class="code-function">symbols</span>(<span class="code-string">'x'</span>)

<span class="code-comment"># Expand (x + 2)(x + 3)</span>
expr = (x + <span class="code-number">2</span>) * (x + <span class="code-number">3</span>)
<span class="code-function">print</span>(<span class="code-function">expand</span>(expr))  <span class="code-comment"># x² + 5x + 6</span>

<span class="code-comment"># Works with any polynomial</span>
<span class="code-function">print</span>(<span class="code-function">expand</span>((x + <span class="code-number">1</span>)**<span class="code-number">3</span>))  <span class="code-comment"># x³ + 3x² + 3x + 1</span></pre></div>
            </div>
          </div>

          <div class="subsection">
            <h3 class="subsection-title">Multiple terms</h3>
            <div class="math-block">(x + 1)(x² + 2x + 1)

Distribute each term:
= x(x² + 2x + 1) + 1(x² + 2x + 1)
= x³ + 2x² + x + x² + 2x + 1
= x³ + 3x² + 3x + 1</div>
          </div>
        </div>
      </section>

      <!-- Factoring -->
      <section class="section" id="factor">
        <div class="section-header">
          <div class="section-number">Section 2</div>
          <h2 class="section-title">Factoring Expressions</h2>
        </div>
        <div class="section-body">
          <div class="subsection">
            <h3 class="subsection-title">Greatest Common Factor (GCF)</h3>
            <div class="rule">
              <strong>Step 1:</strong> Always look for a GCF first. Factor it out.
            </div>
            <div class="math-block">6x² + 9x = 3x(2x + 3)

15a³b² - 10a²b = 5a²b(3ab - 2)</div>
          </div>

          <div class="subsection">
            <h3 class="subsection-title">Factoring quadratics: x² + bx + c</h3>
            <p>Find two numbers that multiply to c and add to b.</p>
            <div class="math-block">x² + 7x + 12

Need: p × q = 12 and p + q = 7
Try: 3 × 4 = 12, 3 + 4 = 7 ✓

Result: (x + 3)(x + 4)</div>
            <div class="code-block">
              <div class="code-header"><span class="code-lang">Python</span><span class="code-label">Factoring with SymPy</span></div>
              <div class="code-content"><pre><span class="code-keyword">from</span> sympy <span class="code-keyword">import</span> symbols, factor

x = <span class="code-function">symbols</span>(<span class="code-string">'x'</span>)

<span class="code-function">print</span>(<span class="code-function">factor</span>(x**<span class="code-number">2</span> + <span class="code-number">7</span>*x + <span class="code-number">12</span>))  <span class="code-comment"># (x + 3)(x + 4)</span>
<span class="code-function">print</span>(<span class="code-function">factor</span>(x**<span class="code-number">2</span> - <span class="code-number">9</span>))         <span class="code-comment"># (x - 3)(x + 3)</span>
<span class="code-function">print</span>(<span class="code-function">factor</span>(x**<span class="code-number">3</span> - <span class="code-number">8</span>))         <span class="code-comment"># (x - 2)(x² + 2x + 4)</span></pre></div>
            </div>
          </div>

          <div class="subsection">
            <h3 class="subsection-title">Factoring ax² + bx + c (a ≠ 1)</h3>
            <div class="math-block">2x² + 7x + 3

Method: Find numbers that multiply to a×c = 6 and add to b = 7
Try: 1 × 6 = 6, 1 + 6 = 7 ✓

Rewrite middle term:
2x² + x + 6x + 3

Factor by grouping:
x(2x + 1) + 3(2x + 1)
(x + 3)(2x + 1)</div>
          </div>

          <div class="subsection">
            <h3 class="subsection-title">Factoring by grouping</h3>
            <div class="math-block">x³ + 3x² + 2x + 6

Group: (x³ + 3x²) + (2x + 6)
Factor each: x²(x + 3) + 2(x + 3)
Common factor: (x² + 2)(x + 3)</div>
          </div>
        </div>
      </section>

      <!-- Simplifying -->
      <section class="section" id="simplify">
        <div class="section-header">
          <div class="section-number">Section 3</div>
          <h2 class="section-title">Simplifying Expressions</h2>
        </div>
        <div class="section-body">
          <div class="subsection">
            <h3 class="subsection-title">Combining like terms</h3>
            <div class="math-block">3x² + 5x - 2x² + 7 - 3x + 1
= (3x² - 2x²) + (5x - 3x) + (7 + 1)
= x² + 2x + 8</div>
          </div>

          <div class="subsection">
            <h3 class="subsection-title">Simplifying fractions</h3>
            <div class="rule">Factor numerator and denominator, then cancel common factors.</div>
            <div class="math-block">(x² - 4) / (x + 2)

Factor numerator: (x - 2)(x + 2) / (x + 2)

Cancel (x + 2): x - 2   (provided x ≠ -2)</div>
            <div class="warning">
              <strong>Domain restriction:</strong> Always note values where the original denominator was zero.
              The simplified form is only valid where the original was defined.
            </div>
          </div>

          <div class="subsection">
            <h3 class="subsection-title">Exponent rules</h3>
            <div class="math-block">Product rule:     aᵐ · aⁿ = aᵐ⁺ⁿ
Quotient rule:    aᵐ / aⁿ = aᵐ⁻ⁿ
Power rule:       (aᵐ)ⁿ = aᵐⁿ
Zero exponent:    a⁰ = 1 (a ≠ 0)
Negative:         a⁻ⁿ = 1/aⁿ</div>
            <div class="code-block">
              <div class="code-header"><span class="code-lang">Python</span><span class="code-label">Simplifying with SymPy</span></div>
              <div class="code-content"><pre><span class="code-keyword">from</span> sympy <span class="code-keyword">import</span> symbols, simplify, cancel

x = <span class="code-function">symbols</span>(<span class="code-string">'x'</span>)

<span class="code-comment"># Simplify rational expression</span>
expr = (x**<span class="code-number">2</span> - <span class="code-number">4</span>) / (x + <span class="code-number">2</span>)
<span class="code-function">print</span>(<span class="code-function">cancel</span>(expr))  <span class="code-comment"># x - 2</span>

<span class="code-comment"># Simplify complex expression</span>
expr2 = (x**<span class="code-number">3</span> + x**<span class="code-number">2</span>) / (x**<span class="code-number">2</span> + x)
<span class="code-function">print</span>(<span class="code-function">simplify</span>(expr2))  <span class="code-comment"># x</span></pre></div>
            </div>
          </div>
        </div>
      </section>

      <!-- Special Forms -->
      <section class="section" id="special">
        <div class="section-header">
          <div class="section-number">Section 4</div>
          <h2 class="section-title">Special Forms (Memorize These)</h2>
        </div>
        <div class="section-body">
          <div class="subsection">
            <h3 class="subsection-title">Difference of squares</h3>
            <div class="math-block">a² - b² = (a + b)(a - b)

Examples:
  x² - 9 = (x + 3)(x - 3)
  4x² - 25 = (2x + 5)(2x - 5)
  x⁴ - 1 = (x² + 1)(x² - 1) = (x² + 1)(x + 1)(x - 1)</div>
          </div>

          <div class="subsection">
            <h3 class="subsection-title">Perfect square trinomials</h3>
            <div class="math-block">(a + b)² = a² + 2ab + b²
(a - b)² = a² - 2ab + b²

Examples:
  x² + 6x + 9 = (x + 3)²
  x² - 10x + 25 = (x - 5)²

Recognition: Is the middle term 2 × √first × √last?</div>
          </div>

          <div class="subsection">
            <h3 class="subsection-title">Sum/difference of cubes</h3>
            <div class="math-block">a³ + b³ = (a + b)(a² - ab + b²)
a³ - b³ = (a - b)(a² + ab + b²)

Examples:
  x³ + 8 = (x + 2)(x² - 2x + 4)
  x³ - 27 = (x - 3)(x² + 3x + 9)</div>
            <div class="info">
              <strong>Mnemonic:</strong> SOAP — Same, Opposite, Always Positive.
              <br>First sign is Same as original, second is Opposite, last is Always Positive.
            </div>
          </div>

          <div class="subsection">
            <h3 class="subsection-title">CS application: Boolean algebra</h3>
            <div class="code-block">
              <div class="code-header"><span class="code-lang">Python</span><span class="code-label">De Morgan's laws = factoring for booleans</span></div>
              <div class="code-content"><pre><span class="code-comment"># De Morgan's Laws (factoring for booleans)</span>
<span class="code-comment"># not(A and B) = (not A) or (not B)</span>
<span class="code-comment"># not(A or B)  = (not A) and (not B)</span>

<span class="code-comment"># Before: complex nested condition</span>
<span class="code-keyword">if</span> <span class="code-keyword">not</span> (is_admin <span class="code-keyword">and</span> is_active):
    deny_access()

<span class="code-comment"># After: simplified using De Morgan</span>
<span class="code-keyword">if</span> (<span class="code-keyword">not</span> is_admin) <span class="code-keyword">or</span> (<span class="code-keyword">not</span> is_active):
    deny_access()

<span class="code-comment"># Distributive law for booleans</span>
<span class="code-comment"># A and (B or C) = (A and B) or (A and C)</span>
<span class="code-comment"># Same as: a(b + c) = ab + ac</span></pre></div>
            </div>
          </div>
        </div>
      </section>

      <!-- Gotchas -->
      <section class="section" id="gotchas">
        <div class="section-header">
          <div class="section-number">Section 5</div>
          <h2 class="section-title">Common Gotchas</h2>
        </div>
        <div class="section-body">
          <div class="warning">
            <strong>1. Sign errors when distributing negatives</strong><br>
            -(x - 3) = -x + 3, NOT -x - 3
          </div>
          <div class="warning">
            <strong>2. Forgetting the middle term in squares</strong><br>
            (x + 3)² = x² + 6x + 9, NOT x² + 9
          </div>
          <div class="warning">
            <strong>3. Canceling across addition</strong><br>
            (x + 2)/2 ≠ x + 1. You can only cancel factors, not terms!
          </div>
          <div class="warning">
            <strong>4. Sum of squares doesn't factor</strong><br>
            a² + b² has no real factorization. Only difference of squares factors.
          </div>
          <div class="warning">
            <strong>5. Losing domain restrictions</strong><br>
            (x² - 4)/(x - 2) = x + 2, but only for x ≠ 2.
          </div>
        </div>
      </section>

      <!-- Videos -->
      <section class="section" id="videos">
        <div class="section-header">
          <div class="section-number">Section 6</div>
          <h2 class="section-title">Video Lessons</h2>
        </div>
        <div class="section-body">
          <p>Click any video to play.</p>
          <div class="video-container">
            <div class="video-player">
              <iframe id="ytPlayer" src="" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
              <div class="video-info">
                <div class="video-title" id="videoTitle">Select a video</div>
                <div class="video-meta" id="videoMeta"></div>
              </div>
            </div>
            <div class="video-list" id="videoList"></div>
          </div>
        </div>
      </section>

      <!-- Practice -->
      <section class="section" id="practice">
        <div class="section-header">
          <div class="section-number">Section 7</div>
          <h2 class="section-title">Practice Problems</h2>
        </div>
        <div class="section-body">
          <p>Type your answer. Use ^ for exponents (e.g., x^2 for x²). Factored forms should match the answer format shown.</p>
          <div class="quiz-controls">
            <button class="btn btn-primary" id="btnCheckAll">Check All</button>
            <button class="btn" id="btnRevealAll">Reveal All</button>
            <button class="btn" id="btnClear">Clear Inputs</button>
            <button class="btn btn-danger" id="btnReset">Reset Stats</button>
          </div>
          <div id="quizContainer"></div>
        </div>
      </section>
    </main>
  </div>

  <script>
    // Utilities
    function normalize(s) {
      if (!s) return "";
      return s.trim().toLowerCase()
        .replace(/\s+/g, "")
        .replace(/\*\*/g, "^")
        .replace(/\^1(?!\d)/g, "")
        .replace(/\+\-/g, "-")
        .replace(/\-\+/g, "-");
    }

    function checkAnswer(input, expected) {
      const norm = normalize(input);
      const answers = expected.map(a => normalize(a));
      return answers.includes(norm);
    }

    // Quiz Data
    const QUESTIONS = [
      { id: 1, topic: "Expand", prompt: "Expand: 3(x + 5)", answer: ["3x+15"], display: "3x + 15" },
      { id: 2, topic: "Expand", prompt: "Expand: -2(4x - 3)", answer: ["-8x+6"], display: "-8x + 6" },
      { id: 3, topic: "Expand", prompt: "Expand: (x + 2)(x + 5)", answer: ["x^2+7x+10"], display: "x² + 7x + 10" },
      { id: 4, topic: "Expand", prompt: "Expand: (x - 3)(x + 4)", answer: ["x^2+x-12"], display: "x² + x - 12" },
      { id: 5, topic: "Expand", prompt: "Expand: (2x + 1)(x - 3)", answer: ["2x^2-5x-3"], display: "2x² - 5x - 3" },
      { id: 6, topic: "Factor", prompt: "Factor: x² + 5x + 6", answer: ["(x+2)(x+3)", "(x+3)(x+2)"], display: "(x + 2)(x + 3)" },
      { id: 7, topic: "Factor", prompt: "Factor: x² - 9", answer: ["(x+3)(x-3)", "(x-3)(x+3)"], display: "(x + 3)(x - 3)" },
      { id: 8, topic: "Factor", prompt: "Factor: x² - 5x + 6", answer: ["(x-2)(x-3)", "(x-3)(x-2)"], display: "(x - 2)(x - 3)" },
      { id: 9, topic: "Factor", prompt: "Factor: 2x² + 5x + 3", answer: ["(2x+3)(x+1)", "(x+1)(2x+3)"], display: "(2x + 3)(x + 1)" },
      { id: 10, topic: "Factor", prompt: "Factor: x² + 6x + 9", answer: ["(x+3)^2", "(x+3)(x+3)"], display: "(x + 3)²" },
      { id: 11, topic: "Factor", prompt: "Factor: 4x² - 25", answer: ["(2x+5)(2x-5)", "(2x-5)(2x+5)"], display: "(2x + 5)(2x - 5)" },
      { id: 12, topic: "Factor", prompt: "Factor: x³ - 8", answer: ["(x-2)(x^2+2x+4)"], display: "(x - 2)(x² + 2x + 4)" },
      { id: 13, topic: "Simplify", prompt: "Simplify: (x² - 4)/(x + 2)", answer: ["x-2"], display: "x - 2" },
      { id: 14, topic: "Simplify", prompt: "Simplify: 5x² + 3x² - 2x + 4x", answer: ["8x^2+2x"], display: "8x² + 2x" },
      { id: 15, topic: "Simplify", prompt: "Simplify: x³ · x⁴ (enter as x^n)", answer: ["x^7"], display: "x⁷" },
      { id: 16, topic: "Simplify", prompt: "Simplify: x⁶/x² (enter as x^n)", answer: ["x^4"], display: "x⁴" },
      { id: 17, topic: "Simplify", prompt: "Simplify: (x³)² (enter as x^n)", answer: ["x^6"], display: "x⁶" },
      { id: 18, topic: "Special", prompt: "Expand: (x + 4)²", answer: ["x^2+8x+16"], display: "x² + 8x + 16" },
      { id: 19, topic: "Special", prompt: "Factor: x³ + 27", answer: ["(x+3)(x^2-3x+9)"], display: "(x + 3)(x² - 3x + 9)" },
      { id: 20, topic: "GCF", prompt: "Factor out GCF: 6x³ - 9x²", answer: ["3x^2(2x-3)"], display: "3x²(2x - 3)" },
    ];

    // State
    const LS_KEY = "day4_stats_v1";
    let stats = loadStats();
    let sessionCorrect = 0;

    function loadStats() {
      try {
        const raw = localStorage.getItem(LS_KEY);
        return raw ? JSON.parse(raw) : { attempted: 0, correct: 0 };
      } catch { return { attempted: 0, correct: 0 }; }
    }

    function saveStats() {
      localStorage.setItem(LS_KEY, JSON.stringify(stats));
    }

    function updateUI() {
      document.getElementById("statAttempted").textContent = stats.attempted;
      document.getElementById("statCorrect").textContent = stats.correct;
      document.getElementById("statAccuracy").textContent = stats.attempted > 0 
        ? `${Math.round((stats.correct / stats.attempted) * 100)}%` : "—";
      const pct = Math.round((sessionCorrect / QUESTIONS.length) * 100);
      document.getElementById("progressText").textContent = `${sessionCorrect} / ${QUESTIONS.length} complete`;
      document.getElementById("progressFill").style.width = `${pct}%`;
    }

    // Quiz
    function renderQuiz() {
      const container = document.getElementById("quizContainer");
      container.innerHTML = "";
      QUESTIONS.forEach(q => {
        const div = document.createElement("div");
        div.className = "question";
        div.innerHTML = `
          <div class="question-header">
            <span class="question-num">Q${q.id}</span>
            <span class="question-topic">${q.topic}</span>
          </div>
          <div class="question-prompt">${q.prompt}</div>
          <div class="question-input-row">
            <input type="text" class="question-input" placeholder="Your answer..." />
            <button class="btn btn-primary btn-check">Check</button>
            <button class="btn btn-show">Show</button>
          </div>
          <div class="question-result"></div>
        `;
        const input = div.querySelector(".question-input");
        const result = div.querySelector(".question-result");
        div.querySelector(".btn-check").addEventListener("click", () => check(q, input, result));
        input.addEventListener("keydown", e => { if (e.key === "Enter") check(q, input, result); });
        div.querySelector(".btn-show").addEventListener("click", () => {
          result.innerHTML = `<div class="question-answer">Answer: ${q.display}</div>`;
        });
        container.appendChild(div);
      });
    }

    function check(q, input, result) {
      stats.attempted++;
      const ok = checkAnswer(input.value, q.answer);
      if (ok) {
        stats.correct++;
        sessionCorrect++;
        input.classList.remove("incorrect");
        input.classList.add("correct");
        result.innerHTML = `<span class="success">✓ Correct</span>`;
      } else {
        input.classList.remove("correct");
        input.classList.add("incorrect");
        result.innerHTML = `<span class="error">✗ Not quite</span>`;
      }
      saveStats();
      updateUI();
    }

    document.getElementById("btnCheckAll").addEventListener("click", () => {
      document.querySelectorAll(".btn-check").forEach(b => b.click());
    });
    document.getElementById("btnRevealAll").addEventListener("click", () => {
      document.querySelectorAll(".btn-show").forEach(b => b.click());
    });
    document.getElementById("btnClear").addEventListener("click", () => {
      document.querySelectorAll(".question-input").forEach(i => {
        i.value = ""; i.classList.remove("correct", "incorrect");
      });
      document.querySelectorAll(".question-result").forEach(r => r.innerHTML = "");
      sessionCorrect = 0;
      updateUI();
    });
    document.getElementById("btnReset").addEventListener("click", () => {
      if (!confirm("Reset all stats?")) return;
      stats = { attempted: 0, correct: 0 };
      saveStats();
      sessionCorrect = 0;
      updateUI();
    });

    // Videos
    const VIDEO_GROUPS = [
      { title: "Expanding", items: [
        { title: "Math Antics — Distributive Property", channel: "Math Antics", vid: "v-6MShC82ow" },
        { title: "Khan Academy — Multiplying Binomials", channel: "Khan Academy", vid: "ZMLFfTX615w" },
      ]},
      { title: "Factoring", items: [
        { title: "Organic Chem Tutor — Factoring Trinomials", channel: "Organic Chemistry Tutor", vid: "5QyeWV7hMf8" },
        { title: "Khan Academy — Factoring Quadratics", channel: "Khan Academy", vid: "eF6zYNzlZKQ" },
        { title: "Professor Leonard — Factoring Completely", channel: "Professor Leonard", vid: "2ZzuZvz33X0" },
      ]},
      { title: "Special Forms", items: [
        { title: "Khan Academy — Difference of Squares", channel: "Khan Academy", vid: "tvnOWIoeeaU" },
        { title: "Organic Chem Tutor — Perfect Square Trinomials", channel: "Organic Chemistry Tutor", vid: "PIwGFrJcXJY" },
        { title: "Khan Academy — Sum/Difference of Cubes", channel: "Khan Academy", vid: "M3sLfYwBfHE" },
      ]},
    ];

    function renderVideos() {
      const container = document.getElementById("videoList");
      container.innerHTML = "";
      let idx = 0;
      VIDEO_GROUPS.forEach(group => {
        const title = document.createElement("div");
        title.className = "video-group-title";
        title.textContent = group.title;
        container.appendChild(title);
        group.items.forEach(item => {
          idx++;
          const btn = document.createElement("button");
          btn.className = "video-item";
          btn.innerHTML = `<span class="video-num">${idx}</span><div><div class="video-item-title">${item.title}</div><div class="video-item-desc">${item.channel}</div></div>`;
          btn.addEventListener("click", () => setVideo(item, btn));
          container.appendChild(btn);
        });
      });
      const first = VIDEO_GROUPS[0].items[0];
      setVideo(first, container.querySelector(".video-item"));
    }

    function setVideo(item, btn) {
      document.querySelectorAll(".video-item").forEach(b => b.classList.remove("active"));
      if (btn) btn.classList.add("active");
      document.getElementById("ytPlayer").src = `https://www.youtube.com/embed/${item.vid}?rel=0`;
      document.getElementById("videoTitle").textContent = item.title;
      document.getElementById("videoMeta").textContent = item.channel;
    }

    // TOC
    const tocLinks = document.querySelectorAll(".toc-link");
    const sections = document.querySelectorAll(".section");
    function updateToc() {
      let current = "";
      sections.forEach(s => { if (s.getBoundingClientRect().top < 150) current = s.id; });
      tocLinks.forEach(l => l.classList.toggle("active", l.getAttribute("href") === `#${current}`));
    }
    window.addEventListener("scroll", updateToc);

    // Theme toggle
    const sunIcon = `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>`;
    const moonIcon = `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>`;
    const themeToggle = document.getElementById('themeToggle');
    function updateThemeIcon() { themeToggle.innerHTML = document.documentElement.getAttribute('data-theme') === 'dark' ? sunIcon : moonIcon; }
    themeToggle.addEventListener('click', () => {
      const next = document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
      document.documentElement.setAttribute('data-theme', next);
      localStorage.setItem('math_cs_theme', next);
      updateThemeIcon();
    });
    updateThemeIcon();

    // Init
    renderQuiz();
    renderVideos();
    updateUI();
    updateToc();
  </script>
</body>
</html>
